{"ast":null,"code":"import { EventStreamMarshaller as EventMarshaller } from \"@aws-sdk/eventstream-marshaller\";\nimport { EventStreamMarshaller as UniversalEventStreamMarshaller } from \"@aws-sdk/eventstream-serde-universal\";\nimport { iterableToReadableStream, readableStreamtoIterable } from \"./utils\";\n/**\n * Utility class used to serialize and deserialize event streams in\n * browsers and ReactNative.\n *\n * In browsers where ReadableStream API is available:\n * * deserialize from ReadableStream to an async iterable of output structure\n * * serialize from async iterable of input structure to ReadableStream\n * In ReactNative where only async iterable API is available:\n * * deserialize from async iterable of binaries to async iterable of output structure\n * * serialize from async iterable of input structure to async iterable of binaries\n *\n * We use ReadableStream API in browsers because of the consistency with other\n * streaming operations, where ReadableStream API is used to denote streaming data.\n * Whereas in ReactNative, ReadableStream API is not available, we use async iterable\n * for streaming data although it has lower throughput.\n */\n\nvar EventStreamMarshaller =\n/** @class */\nfunction () {\n  function EventStreamMarshaller(_a) {\n    var utf8Encoder = _a.utf8Encoder,\n        utf8Decoder = _a.utf8Decoder;\n    this.eventMarshaller = new EventMarshaller(utf8Encoder, utf8Decoder);\n    this.universalMarshaller = new UniversalEventStreamMarshaller({\n      utf8Decoder: utf8Decoder,\n      utf8Encoder: utf8Encoder\n    });\n  }\n\n  EventStreamMarshaller.prototype.deserialize = function (body, deserializer) {\n    var bodyIterable = isReadableStream(body) ? readableStreamtoIterable(body) : body;\n    return this.universalMarshaller.deserialize(bodyIterable, deserializer);\n  };\n  /**\n   * Generate a stream that serialize events into stream of binary chunks;\n   *\n   * Caveat is that streaming request payload doesn't work on browser with native\n   * xhr or fetch handler currently because they don't support upload streaming.\n   * reference:\n   * * https://bugs.chromium.org/p/chromium/issues/detail?id=688906\n   * * https://bugzilla.mozilla.org/show_bug.cgi?id=1387483\n   *\n   */\n\n\n  EventStreamMarshaller.prototype.serialize = function (input, serializer) {\n    var serialziedIterable = this.universalMarshaller.serialize(input, serializer);\n    return typeof ReadableStream === \"function\" ? iterableToReadableStream(serialziedIterable) : serialziedIterable;\n  };\n\n  return EventStreamMarshaller;\n}();\n\nexport { EventStreamMarshaller };\n\nvar isReadableStream = function (body) {\n  return typeof ReadableStream === \"function\" && body instanceof ReadableStream;\n};","map":{"version":3,"sources":["c:/work/NodeProjects/hospitaliot/node_modules/@aws-sdk/eventstream-serde-browser/dist/es/EventStreamMarshaller.js"],"names":["EventStreamMarshaller","EventMarshaller","UniversalEventStreamMarshaller","iterableToReadableStream","readableStreamtoIterable","_a","utf8Encoder","utf8Decoder","eventMarshaller","universalMarshaller","prototype","deserialize","body","deserializer","bodyIterable","isReadableStream","serialize","input","serializer","serialziedIterable","ReadableStream"],"mappings":"AAAA,SAASA,qBAAqB,IAAIC,eAAlC,QAAyD,iCAAzD;AACA,SAASD,qBAAqB,IAAIE,8BAAlC,QAAwE,sCAAxE;AACA,SAASC,wBAAT,EAAmCC,wBAAnC,QAAmE,SAAnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIJ,qBAAqB;AAAG;AAAe,YAAY;AACnD,WAASA,qBAAT,CAA+BK,EAA/B,EAAmC;AAC/B,QAAIC,WAAW,GAAGD,EAAE,CAACC,WAArB;AAAA,QAAkCC,WAAW,GAAGF,EAAE,CAACE,WAAnD;AACA,SAAKC,eAAL,GAAuB,IAAIP,eAAJ,CAAoBK,WAApB,EAAiCC,WAAjC,CAAvB;AACA,SAAKE,mBAAL,GAA2B,IAAIP,8BAAJ,CAAmC;AAC1DK,MAAAA,WAAW,EAAEA,WAD6C;AAE1DD,MAAAA,WAAW,EAAEA;AAF6C,KAAnC,CAA3B;AAIH;;AACDN,EAAAA,qBAAqB,CAACU,SAAtB,CAAgCC,WAAhC,GAA8C,UAAUC,IAAV,EAAgBC,YAAhB,EAA8B;AACxE,QAAIC,YAAY,GAAGC,gBAAgB,CAACH,IAAD,CAAhB,GAAyBR,wBAAwB,CAACQ,IAAD,CAAjD,GAA0DA,IAA7E;AACA,WAAO,KAAKH,mBAAL,CAAyBE,WAAzB,CAAqCG,YAArC,EAAmDD,YAAnD,CAAP;AACH,GAHD;AAIA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACIb,EAAAA,qBAAqB,CAACU,SAAtB,CAAgCM,SAAhC,GAA4C,UAAUC,KAAV,EAAiBC,UAAjB,EAA6B;AACrE,QAAIC,kBAAkB,GAAG,KAAKV,mBAAL,CAAyBO,SAAzB,CAAmCC,KAAnC,EAA0CC,UAA1C,CAAzB;AACA,WAAO,OAAOE,cAAP,KAA0B,UAA1B,GAAuCjB,wBAAwB,CAACgB,kBAAD,CAA/D,GAAsFA,kBAA7F;AACH,GAHD;;AAIA,SAAOnB,qBAAP;AACH,CA5B0C,EAA3C;;AA6BA,SAASA,qBAAT;;AACA,IAAIe,gBAAgB,GAAG,UAAUH,IAAV,EAAgB;AACnC,SAAO,OAAOQ,cAAP,KAA0B,UAA1B,IAAwCR,IAAI,YAAYQ,cAA/D;AACH,CAFD","sourcesContent":["import { EventStreamMarshaller as EventMarshaller } from \"@aws-sdk/eventstream-marshaller\";\nimport { EventStreamMarshaller as UniversalEventStreamMarshaller } from \"@aws-sdk/eventstream-serde-universal\";\nimport { iterableToReadableStream, readableStreamtoIterable } from \"./utils\";\n/**\n * Utility class used to serialize and deserialize event streams in\n * browsers and ReactNative.\n *\n * In browsers where ReadableStream API is available:\n * * deserialize from ReadableStream to an async iterable of output structure\n * * serialize from async iterable of input structure to ReadableStream\n * In ReactNative where only async iterable API is available:\n * * deserialize from async iterable of binaries to async iterable of output structure\n * * serialize from async iterable of input structure to async iterable of binaries\n *\n * We use ReadableStream API in browsers because of the consistency with other\n * streaming operations, where ReadableStream API is used to denote streaming data.\n * Whereas in ReactNative, ReadableStream API is not available, we use async iterable\n * for streaming data although it has lower throughput.\n */\nvar EventStreamMarshaller = /** @class */ (function () {\n    function EventStreamMarshaller(_a) {\n        var utf8Encoder = _a.utf8Encoder, utf8Decoder = _a.utf8Decoder;\n        this.eventMarshaller = new EventMarshaller(utf8Encoder, utf8Decoder);\n        this.universalMarshaller = new UniversalEventStreamMarshaller({\n            utf8Decoder: utf8Decoder,\n            utf8Encoder: utf8Encoder,\n        });\n    }\n    EventStreamMarshaller.prototype.deserialize = function (body, deserializer) {\n        var bodyIterable = isReadableStream(body) ? readableStreamtoIterable(body) : body;\n        return this.universalMarshaller.deserialize(bodyIterable, deserializer);\n    };\n    /**\n     * Generate a stream that serialize events into stream of binary chunks;\n     *\n     * Caveat is that streaming request payload doesn't work on browser with native\n     * xhr or fetch handler currently because they don't support upload streaming.\n     * reference:\n     * * https://bugs.chromium.org/p/chromium/issues/detail?id=688906\n     * * https://bugzilla.mozilla.org/show_bug.cgi?id=1387483\n     *\n     */\n    EventStreamMarshaller.prototype.serialize = function (input, serializer) {\n        var serialziedIterable = this.universalMarshaller.serialize(input, serializer);\n        return typeof ReadableStream === \"function\" ? iterableToReadableStream(serialziedIterable) : serialziedIterable;\n    };\n    return EventStreamMarshaller;\n}());\nexport { EventStreamMarshaller };\nvar isReadableStream = function (body) {\n    return typeof ReadableStream === \"function\" && body instanceof ReadableStream;\n};\n"]},"metadata":{},"sourceType":"module"}